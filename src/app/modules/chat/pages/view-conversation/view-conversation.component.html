<div *ngIf="(chatService.activeConversation$ |async) as conversation" class="conversation-container">

    <mat-toolbar class="conversation-toolbar mat-elevation-z2">
        <button (click)="closeConversation()" mat-icon-button>
            <mat-icon>arrow_back</mat-icon>
        </button>
        <mat-list>
            <mat-list-item>
                <img matListAvatar src="https://placehold.it/100x100?text=user%20avatar" alt="...">
            </mat-list-item>
        </mat-list>
        <span>{{conversation.name}}</span>
        <span class="spacer"></span>
        <button
                mat-icon-button
                [matMenuTriggerFor]="menu"
                aria-label="More conversation options">
            <mat-icon>more_vert</mat-icon>
        </button>
        <mat-menu #menu="matMenu">
            <button mat-menu-item>
                <mat-icon>dialpad</mat-icon>
                <span>Redial</span>
            </button>
            <button mat-menu-item disabled>
                <mat-icon>voicemail</mat-icon>
                <span>Check voice mail</span>
            </button>
            <button mat-menu-item>
                <mat-icon>notifications_off</mat-icon>
                <span>Disable alerts</span>
            </button>
        </mat-menu>
    </mat-toolbar>

    <section *ngIf="(conversationService.conversationMessages$ | async) as messages" class="messages">
        <div *ngFor="let message of messages; let i = index"
             [ngClass]="{'sent': i%2===0}"
             class="message">
            <mat-list>
                <mat-list-item>
                    <img matListAvatar src="https://placehold.it/100x100?text=user%20avatar" alt="...">
                </mat-list-item>
            </mat-list>
            <!-- <mat-card class="mat-elevation-z"> -->
            <mat-card class="">
                <mat-card-content>
                    <H1>I'AM HERE</H1>
                    <p>
                        {{message.messageBody}}
                    </p>
                </mat-card-content>
            </mat-card>
            <mat-list>
                <mat-list-item>
                    <img matListAvatar src="https://placehold.it/100x100?text=user%20avatar" alt="...">
                </mat-list-item>
            </mat-list>
            <!-- <mat-card class="mat-elevation-z"> -->
            <mat-card class="">
                <mat-card-content>
                    <p>
                        a pariatur esse occaecat quis. In veniam irure minim
                        fugiat nulla exercitation commodo laborum adipisicing Lorem consectetur.
                    </p>
                </mat-card-content>
            </mat-card>
            <mat-list>
                <mat-list-item>
                    <img matListAvatar src="https://placehold.it/100x100?text=user%20avatar" alt="...">
                </mat-list-item>
            </mat-list>
            <!-- <mat-card class="mat-elevation-z"> -->
            <mat-card class="">
                <mat-card-content>
                    <p>
                        a pariatur esse occaecat quis
                    </p>
                </mat-card-content>
            </mat-card>
        </div>
    </section>
    <section *ngIf="!(conversationService.conversationMessages$ | async).length as messages" class="messages">
        <div class="flexed center">
            <h1>NO Messages yet, start by sending one</h1>
        </div>
    </section>

    <form [formGroup]="messageForm" (ngSubmit)="sendMessage()">
        <mat-toolbar class="message-inputs mat-elevation-z8">
            <button mat-icon-button>
                <mat-icon>attachment</mat-icon>
            </button>
            <button mat-icon-button>
                <mat-icon>insert_emoticon</mat-icon>
            </button>
            <mat-form-field appearance="outline">
                <!-- <input matInput value="value"> -->
                <textarea formControlName="messageBody"
                          matInput
                          cdkTextareaAutosize
                          #autosize="cdkTextareaAutosize"
                          cdkAutosizeMinRows="1"
                          cdkAutosizeMaxRows="5"></textarea>
            </mat-form-field>
            <button type="submit" mat-mini-fab color="primary" aria-label="Send message">
                <mat-icon>send</mat-icon>
            </button>
        </mat-toolbar>
    </form>
</div>
